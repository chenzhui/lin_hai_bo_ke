{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getCurrentInstance } from \"vue\";\nexport default {\n  setup() {\n    const gci = getCurrentInstance;\n    gci.data.dollarws = {\n      ws: {},\n      //websocket对象\n      delay: 1500,\n      //重连延迟，单位：毫秒\n      setWs: function (newWs) {\n        this.ws = newWs;\n      }\n    };\n    gci.data.Socket = function () {\n      gci.data.ws = new WebSocket('ws://114.55.38.94/Chat/' + gci.data.id);\n      gci.data.dollarws.setWs(gci.data.ws);\n      gci.data.ws.onopen = function () {};\n      gci.data.ws.onmessage = function (data) {\n        gci.data.chats.push(JSON.parse(data.data));\n      };\n      gci.data.ws.onerror = function () {\n        console.log(\"连接已出错...\");\n        setTimeout(() => {\n          gci.data.socket();\n        }, gci.data.dollarws.delay);\n      };\n      gci.data.ws.onclose = function () {\n        setTimeout(() => {\n          gci.data.Socket();\n        }, 2000);\n      };\n    };\n    gci.data.Socket();\n  },\n  data() {\n    return {\n      ws: \"\",\n      dollarws: \"\"\n    };\n  }\n};","map":{"version":3,"names":["getCurrentInstance","setup","gci","data","dollarws","ws","delay","setWs","newWs","Socket","WebSocket","id","onopen","onmessage","chats","push","JSON","parse","onerror","console","log","setTimeout","socket","onclose"],"sources":["D:\\lin_hai_bo_ke\\qian_duan_2\\src\\Views\\ChatRoom.vue"],"sourcesContent":["<template>\r\n  <div style=\"display:flex;flex-direction:column;width:600px;background-color:white;margin-left:20px;\">\r\n        <div style=\"display:flex;height:30px;background-color:lightblue;align-items:center;\">\r\n          <p style=\"margin-left:300px;color:white;width:200px;font-size:25px;\">在线聊天室</p>\r\n        </div>\r\n        <div style=\"height:550px;border-bottom:solid 1px black;overflow:auto;\">\r\n          <div v-for=\"item in chats\" :key=\"chats.indexOf(item)\" style=\"display:flex;flex-direction:column;margin-top:10px;\">\r\n            <div v-if=\"item.id!=id\" style=\"display:flex;\"><p style=\"align-self:center;\">{{item.name}}</p><p style=\"margin-left:20px;background-color:lightgrey;border-radius:5px;padding:8px;max-width:200px;\">{{item.message}}</p></div>\r\n            <div v-else style=\"display:flex;flex-direction:row-reverse\"><p style=\"align-self:center;\">{{item.name}}</p><p style=\"margin-right:20px;background-color:deepskyblue;border-radius:5px;padding:8px;max-width:200px;\">{{item.message}}</p></div>\r\n          </div>\r\n        </div>\r\n        <div style=\"display:flex;flex-direction:column;\">\r\n          <textarea @keydown.enter=\"SendMessage\" v-model=\"chatInput\" style=\"height:60px;resize:none;\"></textarea>\r\n          <button style=\"cursor:pointer;margin-left:600px;width:100px;height:30px;background-color:lightblue\"  @click=\"SendMessage\">发送</button>\r\n        </div>\r\n      </div>\r\n</template>\r\n<script>\r\nimport {getCurrentInstance} from \"vue\";\r\n\r\nexport default {\r\nsetup(){\r\n  const gci=getCurrentInstance;\r\n  gci.data.dollarws={\r\n  ws:{},//websocket对象\r\n  delay:1500,//重连延迟，单位：毫秒\r\n  setWs: function(newWs) {this.ws = newWs}}\r\n  gci.data.Socket=function(){\r\n      gci.data.ws = new WebSocket('ws://114.55.38.94/Chat/'+gci.data.id);\r\n      gci.data.dollarws.setWs(gci.data.ws);\r\n      gci.data.ws.onopen =function(){};\r\n      gci.data.ws.onmessage=function(data){gci.data.chats.push(JSON.parse(data.data))}\r\n      gci.data.ws.onerror = function(){console.log(\"连接已出错...\");setTimeout(()=>{gci.data.socket()},gci.data.dollarws.delay)}\r\n      gci.data.ws.onclose = function(){setTimeout(()=>{gci.data.Socket()},2000)}\r\n  }\r\n  gci.data.Socket()\r\n},\r\ndata(){\r\n  return{\r\n    ws:\"\",\r\n    dollarws:\"\"\r\n  }\r\n}\r\n\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\n\r\n</style>"],"mappings":";AAkBA,SAAQA,kBAAkB,QAAO,KAAK;AAEtC,eAAe;EACfC,KAAKA,CAAA,EAAE;IACL,MAAMC,GAAG,GAACF,kBAAkB;IAC5BE,GAAG,CAACC,IAAI,CAACC,QAAQ,GAAC;MAClBC,EAAE,EAAC,CAAC,CAAC;MAAC;MACNC,KAAK,EAAC,IAAI;MAAC;MACXC,KAAK,EAAE,SAAAA,CAASC,KAAK,EAAE;QAAC,IAAI,CAACH,EAAC,GAAIG,KAAK;MAAA;IAAC;IACxCN,GAAG,CAACC,IAAI,CAACM,MAAM,GAAC,YAAU;MACtBP,GAAG,CAACC,IAAI,CAACE,EAAC,GAAI,IAAIK,SAAS,CAAC,yBAAyB,GAACR,GAAG,CAACC,IAAI,CAACQ,EAAE,CAAC;MAClET,GAAG,CAACC,IAAI,CAACC,QAAQ,CAACG,KAAK,CAACL,GAAG,CAACC,IAAI,CAACE,EAAE,CAAC;MACpCH,GAAG,CAACC,IAAI,CAACE,EAAE,CAACO,MAAK,GAAG,YAAU,CAAC,CAAC;MAChCV,GAAG,CAACC,IAAI,CAACE,EAAE,CAACQ,SAAS,GAAC,UAASV,IAAI,EAAC;QAACD,GAAG,CAACC,IAAI,CAACW,KAAK,CAACC,IAAI,CAACC,IAAI,CAACC,KAAK,CAACd,IAAI,CAACA,IAAI,CAAC,CAAC;MAAA;MAC/ED,GAAG,CAACC,IAAI,CAACE,EAAE,CAACa,OAAM,GAAI,YAAU;QAACC,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;QAACC,UAAU,CAAC,MAAI;UAACnB,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,CAAC;QAAA,CAAC,EAACpB,GAAG,CAACC,IAAI,CAACC,QAAQ,CAACE,KAAK,CAAC;MAAA;MACpHJ,GAAG,CAACC,IAAI,CAACE,EAAE,CAACkB,OAAM,GAAI,YAAU;QAACF,UAAU,CAAC,MAAI;UAACnB,GAAG,CAACC,IAAI,CAACM,MAAM,CAAC,CAAC;QAAA,CAAC,EAAC,IAAI,CAAC;MAAA;IAC7E;IACAP,GAAG,CAACC,IAAI,CAACM,MAAM,CAAC;EAClB,CAAC;EACDN,IAAIA,CAAA,EAAE;IACJ,OAAM;MACJE,EAAE,EAAC,EAAE;MACLD,QAAQ,EAAC;IACX;EACF;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}