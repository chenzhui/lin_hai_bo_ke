{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ImageManager } from \"@/Class/ImageManager\";\nconst DEFAULT_URL = \"http://114.55.38.94:8001/picture/defaultImage.png\";\nconst State = {\n  loading: 0,\n  loaded: 1,\n  error: 2\n};\nexport default class Lazy {\n  constructor(options) {\n    this.managerQueue = [];\n    this.initIntersectionObserver();\n    this.loading = DEFAULT_URL;\n    this.error = DEFAULT_URL;\n  }\n  add(el, binding) {\n    const src = binding.value;\n    const imageManager = new ImageManager({\n      el,\n      src,\n      loading: this.loading,\n      error: this.error\n    });\n    this.managerQueue.push(imageManager);\n    this.observer.observe(el);\n  }\n  initIntersectionObserver() {\n    this.observer = new IntersectionObserver(entries => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) {\n          const manager = this.managerQueue.find(manager => {\n            return manager.el === entry.target;\n          });\n          if (manager) {\n            if (manager.state === State.loaded) {\n              this.removeManager(manager);\n              return;\n            }\n            manager.load();\n          }\n        }\n      });\n    });\n  }\n  removeManager(manager) {\n    const index = this.managerQueue.indexOf(manager);\n    if (index > -1) {\n      this.managerQueue.splice(index, 1);\n    }\n    if (this.observer) {\n      this.observer.unobserve(manager.el);\n    }\n  }\n}","map":{"version":3,"names":["ImageManager","DEFAULT_URL","State","loading","loaded","error","Lazy","constructor","options","managerQueue","initIntersectionObserver","add","el","binding","src","value","imageManager","push","observer","observe","IntersectionObserver","entries","forEach","entry","isIntersecting","manager","find","target","state","removeManager","load","index","indexOf","splice","unobserve"],"sources":["D:/lin_hai_bo_ke/qian_duan_2/src/Class/Lazy.js"],"sourcesContent":["import {ImageManager} from \"@/Class/ImageManager\";\r\n\r\nconst DEFAULT_URL = \"http://114.55.38.94:8001/picture/defaultImage.png\"\r\n\r\nconst State = {\r\n    loading: 0,\r\n    loaded: 1,\r\n    error: 2\r\n}\r\nexport default class Lazy {\r\n    constructor(options) {\r\n        this.managerQueue = []\r\n        this.initIntersectionObserver()\r\n        this.loading =DEFAULT_URL\r\n        this.error = DEFAULT_URL\r\n    }\r\n    add(el,binding) {\r\n        const src = binding.value\r\n        const imageManager = new ImageManager({el, src, loading: this.loading, error: this.error})\r\n        this.managerQueue.push(imageManager)\r\n        this.observer.observe(el)\r\n    }\r\n    initIntersectionObserver() {\r\n        this.observer = new IntersectionObserver((entries) => {\r\n            entries.forEach((entry) => {\r\n                if (entry.isIntersecting) {\r\n                    const manager = this.managerQueue.find((manager)=>{return manager.el === entry.target})\r\n                    if (manager) {\r\n                        if (manager.state === State.loaded) {\r\n                            this.removeManager(manager)\r\n                            return\r\n                        }\r\n                        manager.load()\r\n                    }\r\n                }\r\n            })\r\n        })\r\n    }\r\n    removeManager(manager) {\r\n        const index = this.managerQueue.indexOf(manager)\r\n        if (index > -1) {\r\n            this.managerQueue.splice(index, 1)\r\n        }\r\n        if (this.observer) {\r\n            this.observer.unobserve(manager.el)\r\n        }\r\n    }\r\n}\r\n\r\n"],"mappings":";AAAA,SAAQA,YAAY,QAAO,sBAAsB;AAEjD,MAAMC,WAAW,GAAG,mDAAmD;AAEvE,MAAMC,KAAK,GAAG;EACVC,OAAO,EAAE,CAAC;EACVC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE;AACX,CAAC;AACD,eAAe,MAAMC,IAAI,CAAC;EACtBC,WAAWA,CAACC,OAAO,EAAE;IACjB,IAAI,CAACC,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,wBAAwB,CAAC,CAAC;IAC/B,IAAI,CAACP,OAAO,GAAEF,WAAW;IACzB,IAAI,CAACI,KAAK,GAAGJ,WAAW;EAC5B;EACAU,GAAGA,CAACC,EAAE,EAACC,OAAO,EAAE;IACZ,MAAMC,GAAG,GAAGD,OAAO,CAACE,KAAK;IACzB,MAAMC,YAAY,GAAG,IAAIhB,YAAY,CAAC;MAACY,EAAE;MAAEE,GAAG;MAAEX,OAAO,EAAE,IAAI,CAACA,OAAO;MAAEE,KAAK,EAAE,IAAI,CAACA;IAAK,CAAC,CAAC;IAC1F,IAAI,CAACI,YAAY,CAACQ,IAAI,CAACD,YAAY,CAAC;IACpC,IAAI,CAACE,QAAQ,CAACC,OAAO,CAACP,EAAE,CAAC;EAC7B;EACAF,wBAAwBA,CAAA,EAAG;IACvB,IAAI,CAACQ,QAAQ,GAAG,IAAIE,oBAAoB,CAAEC,OAAO,IAAK;MAClDA,OAAO,CAACC,OAAO,CAAEC,KAAK,IAAK;QACvB,IAAIA,KAAK,CAACC,cAAc,EAAE;UACtB,MAAMC,OAAO,GAAG,IAAI,CAAChB,YAAY,CAACiB,IAAI,CAAED,OAAO,IAAG;YAAC,OAAOA,OAAO,CAACb,EAAE,KAAKW,KAAK,CAACI,MAAM;UAAA,CAAC,CAAC;UACvF,IAAIF,OAAO,EAAE;YACT,IAAIA,OAAO,CAACG,KAAK,KAAK1B,KAAK,CAACE,MAAM,EAAE;cAChC,IAAI,CAACyB,aAAa,CAACJ,OAAO,CAAC;cAC3B;YACJ;YACAA,OAAO,CAACK,IAAI,CAAC,CAAC;UAClB;QACJ;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;EACN;EACAD,aAAaA,CAACJ,OAAO,EAAE;IACnB,MAAMM,KAAK,GAAG,IAAI,CAACtB,YAAY,CAACuB,OAAO,CAACP,OAAO,CAAC;IAChD,IAAIM,KAAK,GAAG,CAAC,CAAC,EAAE;MACZ,IAAI,CAACtB,YAAY,CAACwB,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;IACtC;IACA,IAAI,IAAI,CAACb,QAAQ,EAAE;MACf,IAAI,CAACA,QAAQ,CAACgB,SAAS,CAACT,OAAO,CAACb,EAAE,CAAC;IACvC;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}