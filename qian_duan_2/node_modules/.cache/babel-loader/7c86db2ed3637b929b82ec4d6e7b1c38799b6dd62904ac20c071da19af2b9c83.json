{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { getCurrentInstance, onMounted, ref } from \"vue\";\nimport axios from \"axios\";\nimport router from \"../Router/First\";\nexport default {\n  setup() {\n    document.title = \"修改博客\";\n    const gci = getCurrentInstance();\n    let titleRef = ref(null);\n    let typeRef = ref(null);\n    let contentRef = ref(null);\n    let file = ref(null);\n    onMounted(async () => {\n      gci.data.id = gci.appContext.config.globalProperties.$id;\n      gci.data.blogId = router.currentRoute.value.query.blogId;\n      await axios.get('http://114.55.38.94:8001/GetBlog', {\n        params: {\n          \"blogId\": gci.data.blogId\n        }\n      }).then(function (res) {\n        gci.data.blogData = res.data.data;\n      });\n    });\n    return {\n      titleRef,\n      typeRef,\n      contentRef,\n      file\n    };\n  },\n  data() {\n    return {\n      blogData: {},\n      titleOk: true,\n      typeOk: true\n    };\n  },\n  mounted() {\n    window.DeleteImage = this.DeleteImage;\n    window.addEventListener(\"beforeunload\");\n  },\n  methods: {\n    // beforeunloadHandler(e){\n    //   print(e)\n    //   if (e) {\n    //     e = e || window.event;\n    //     if (e) {\n    //       e.returnValue = \"关闭提示\";\n    //     }\n    //     return \"关闭提示\";\n    //   }\n    // },\n    Save(e) {\n      if (e.keyCode == 65) {\n        this.FixBlog();\n      }\n    },\n    FixBlog() {\n      let sureFix = confirm(\"点击“确定”修改,点击”取消“停止\");\n      if (sureFix == true) {\n        const blog = new URLSearchParams();\n        blog.append(\"id\", this.id);\n        blog.append(\"blogId\", this.blogId);\n        blog.append(\"title\", this.titleRef.value);\n        blog.append(\"type\", this.typeRef.value);\n        blog.append(\"content\", this.contentRef.innerHTML);\n        axios.post(\"http://114.55.38.94:8001/FixBlog\", blog).then(function (res) {\n          if (res.data.data == \"修改博客成功\") {\n            alert(\"修改博客成功\");\n            window.close();\n          } else {\n            alert(\"系统繁忙,请稍后重试\");\n          }\n        });\n      }\n      window.close();\n    },\n    AddImage() {\n      let fd = new FormData();\n      fd.append(\"id\", this.id);\n      fd.append(\"file\", this.file.files[0]);\n      const that = this;\n      axios.post(\"http://114.55.38.94:8001/UploadImage\", fd, {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      }).then(res => {\n        that.file.value = '';\n        that.content.innerHTML = that.content.innerHTML + \"<img src='http://114.55.38.94:8001/picture/\" + res.data.data + \"' style='max-width:300px;max-height:300px;min-width:30px;min-height:30px'>\" + \"<div contentEditable style='margin-top:20px;width:700px;min-height:100px;resize:none;font-size:25px;'></div>\";\n      });\n    },\n    DeleteImage() {\n      event.currentTarget.parentElement.remove();\n      axios.get(\"http://114.55.38.94:8001/DeleteImage\", {\n        params: {\n          id: this.id,\n          imageName: event.currentTarget.parentElement.firstElementChild.getAttribute(\"src\")\n        }\n      }).then(() => {});\n    }\n  }\n};","map":{"version":3,"names":["getCurrentInstance","onMounted","ref","axios","router","setup","document","title","gci","titleRef","typeRef","contentRef","file","data","id","appContext","config","globalProperties","$id","blogId","currentRoute","value","query","get","params","then","res","blogData","titleOk","typeOk","mounted","window","DeleteImage","addEventListener","methods","Save","e","keyCode","FixBlog","sureFix","confirm","blog","URLSearchParams","append","innerHTML","post","alert","close","AddImage","fd","FormData","files","that","headers","content","event","currentTarget","parentElement","remove","imageName","firstElementChild","getAttribute"],"sources":["D:\\lin_hai_bo_ke\\qian_duan_2\\src\\Views\\Fixing.vue"],"sourcesContent":["<template>\r\n    <div style=\"display:flex;flex-direction:column;background-color:white;width:1000px;padding-top:10px;\">\r\n      <div style=\"display:flex;align-items:center;\">\r\n        <p style=\"font-size:30px;\">标题:</p>\r\n        <input type=\"text\" ref=\"titleRef\" @keydown.enter=\"typeRef.focus()\" style=\"resize:none;height:30px;width:600px;border-radius:10px;font-size:25px;background-color:lightblue;\" maxlength=\"30\" v-model=\"blogData.title\">\r\n      </div>\r\n      <div style=\"display:flex;align-items:center;margin-top:10px;\">\r\n        <p>类型:</p>\r\n        <input  ref=\"typeRef\" type=\"text\" v-model=\"blogData.type\" style=\"background-color:lightgreen;width:140px;height:30px;border-radius:10px;\" maxlength=\"10\">\r\n      </div>\r\n      <div style=\"display:flex;\">\r\n        <input type=\"file\" ref=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" style=\"height:30px;margin-top:10px;margin-left:2%;opacity:1\"/>\r\n        <button @click=\"AddImage\" style=\"cursor:pointer;background-color:deepskyblue;border-radius:5px;color:white;width:10%;height:30px;margin-top:10px;font-size:1rem;\">添加图片</button>\r\n      </div>\r\n      <div ref=\"contentRef\" style=\"border-top:solid 1px lightgray;margin-top:10px;width:700px;border-bottom:solid 1px lightgray;min-height:700px;\" @keydown.ctrl=\"Save\">\r\n        <div  contenteditable v-html=\"blogData.content\" style=\"width:700px;min-height:50px;resize:none;font-size:25px;\"></div>\r\n      </div>\r\n      <button @click=\"FixBlog\" style=\"align-self:center;background-color:deepskyblue;height:50px;width:200px;cursor:pointer;border-radius:5px;margin-top:30px;color:white;font-size:30px;\">修改</button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {getCurrentInstance, onMounted, ref} from \"vue\";\r\nimport axios from \"axios\";\r\nimport router from \"../Router/First\";\r\nexport default {\r\nsetup(){\r\n  document.title=\"修改博客\"\r\n  const gci=getCurrentInstance()\r\n  let titleRef=ref(null)\r\n  let typeRef=ref(null)\r\n  let contentRef=ref(null)\r\n  let file    = ref(null)\r\n  onMounted(async ()=>{\r\n    gci.data.id = gci.appContext.config.globalProperties.$id\r\n    gci.data.blogId=router.currentRoute.value.query.blogId\r\n    await axios.get('http://114.55.38.94:8001/GetBlog',{params:{\"blogId\":gci.data.blogId}}).then(function (res){\r\n      gci.data.blogData=res.data.data\r\n    })\r\n  })\r\n  return{\r\n    titleRef,typeRef,contentRef,file\r\n  }\r\n},\r\ndata(){\r\n  return{\r\n    blogData:{},\r\n    titleOk:true,\r\n    typeOk:true,\r\n  }\r\n},\r\nmounted(){\r\n  window.DeleteImage=this.DeleteImage\r\n   window.addEventListener(\"beforeunload\", )\r\n},\r\nmethods:{\r\n// beforeunloadHandler(e){\r\n//   print(e)\r\n//   if (e) {\r\n//     e = e || window.event;\r\n//     if (e) {\r\n//       e.returnValue = \"关闭提示\";\r\n//     }\r\n//     return \"关闭提示\";\r\n//   }\r\n// },\r\nSave(e){\r\n  if(e.keyCode==65){\r\n    this.FixBlog()\r\n  }\r\n},\r\nFixBlog(){\r\n  let sureFix=confirm(\"点击“确定”修改,点击”取消“停止\")\r\n  if(sureFix==true){\r\n    const blog=new URLSearchParams\r\n    blog.append(\"id\",this.id);\r\n    blog.append(\"blogId\",this.blogId);\r\n    blog.append(\"title\",this.titleRef.value)\r\n    blog.append(\"type\",this.typeRef.value)\r\n    blog.append(\"content\",this.contentRef.innerHTML)\r\n    axios.post(\"http://114.55.38.94:8001/FixBlog\",blog).then(function (res){\r\n      if(res.data.data==\"修改博客成功\"){\r\n        alert(\"修改博客成功\")\r\n        window.close()\r\n      }else{alert(\"系统繁忙,请稍后重试\")}\r\n    })\r\n  }\r\n  window.close()\r\n},\r\nAddImage(){\r\n  let fd = new FormData\r\n  fd.append(\"id\",this.id)\r\n  fd.append(\"file\",this.file.files[0])\r\n  const that=this\r\n  axios.post(\"http://114.55.38.94:8001/UploadImage\",fd,{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then((res)=>{\r\n    that.file.value=''\r\n    that.content.innerHTML=that.content.innerHTML+\"<img src='http://114.55.38.94:8001/picture/\"+res.data.data+\"' style='max-width:300px;max-height:300px;min-width:30px;min-height:30px'>\"+ \"<div contentEditable style='margin-top:20px;width:700px;min-height:100px;resize:none;font-size:25px;'></div>\"\r\n  })\r\n},\r\nDeleteImage(){\r\n  event.currentTarget.parentElement.remove()\r\n  axios.get(\"http://114.55.38.94:8001/DeleteImage\",{params:{id:this.id,imageName:event.currentTarget.parentElement.firstElementChild.getAttribute(\"src\")}}).then(()=>{})\r\n},\r\n},\r\n}\r\n</script>\r\n<style scoped></style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}