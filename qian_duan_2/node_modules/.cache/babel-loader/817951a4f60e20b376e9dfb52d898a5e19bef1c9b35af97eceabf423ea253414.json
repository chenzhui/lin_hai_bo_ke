{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getCurrentInstance, onMounted } from \"vue\";\nexport default {\n  setup() {\n    const gci = getCurrentInstance();\n    onMounted(() => {\n      gci.data.Socket = function () {\n        gci.data.ws = new WebSocket('ws://localhost:8001/Chat/' + gci.data.id);\n        gci.data.dollarws.setWs(gci.data.ws);\n        gci.data.ws.onopen = function () {};\n        gci.data.ws.onmessage = function (data) {\n          gci.data.chats.push(JSON.parse(data.data));\n        };\n        gci.data.ws.onerror = function () {\n          console.log(\"连接已出错...\");\n          setTimeout(() => {\n            gci.data.socket();\n          }, gci.data.dollarws.delay);\n        };\n        gci.data.ws.onclose = function () {\n          setTimeout(() => {\n            gci.data.Socket();\n          }, 2000);\n        };\n        gci.data.ws.Send = function () {};\n      };\n      gci.data.Socket();\n    });\n    return {};\n  },\n  data() {\n    return {\n      id: 1,\n      chats: [],\n      dollarws: \"\",\n      chatInput: \"\"\n      //ws:\"\",\n    };\n  },\n\n  methods: {\n    SendMessage() {\n      this.dollarws.ws.send(this.chatInput);\n      this.chatInput = \"\";\n    }\n  }\n};","map":{"version":3,"names":["getCurrentInstance","onMounted","setup","gci","data","Socket","ws","WebSocket","id","dollarws","setWs","onopen","onmessage","chats","push","JSON","parse","onerror","console","log","setTimeout","socket","delay","onclose","Send","chatInput","methods","SendMessage","send"],"sources":["D:\\lin_hai_bo_ke\\qian_duan_2\\src\\Views\\ChatRoom.vue"],"sourcesContent":["<template>\r\n  <div style=\"display:flex;flex-direction:column;width:600px;background-color:white;margin-left:20px;\">\r\n        <div style=\"display:flex;height:30px;background-color:lightblue;align-items:center;\">\r\n          <p style=\"margin-left:300px;color:white;width:200px;font-size:25px;\">在线聊天室</p>\r\n        </div>\r\n        <div style=\"height:550px;border-bottom:solid 1px black;overflow:auto;\">\r\n          <div v-for=\"item in chats\" :key=\"chats.indexOf(item)\" style=\"display:flex;flex-direction:column;margin-top:10px;\">\r\n            <div v-if=\"item.id!=id\" style=\"display:flex;\"><p style=\"align-self:center;\">{{item.name}}</p><p style=\"margin-left:20px;background-color:lightgrey;border-radius:5px;padding:8px;max-width:200px;\">{{item.message}}</p></div>\r\n            <div v-else style=\"display:flex;flex-direction:row-reverse\"><p style=\"align-self:center;\">{{item.name}}</p><p style=\"margin-right:20px;background-color:deepskyblue;border-radius:5px;padding:8px;max-width:200px;\">{{item.message}}</p></div>\r\n          </div>\r\n        </div>\r\n        <div style=\"display:flex;flex-direction:column;\">\r\n          <textarea @keydown.enter=\"SendMessage\" v-model=\"chatInput\" style=\"height:60px;resize:none;\"></textarea>\r\n          <button style=\"cursor:pointer;margin-left:600px;width:100px;height:30px;background-color:lightblue\"  @click=\"SendMessage\">发送</button>\r\n        </div>\r\n      </div>\r\n</template>\r\n<script>\r\nimport {getCurrentInstance, onMounted} from \"vue\";\r\n\r\nexport default {\r\nsetup(){\r\n  const gci=getCurrentInstance();\r\n  onMounted(()=>{\r\n    gci.data.Socket=function(){\r\n      gci.data.ws = new WebSocket('ws://localhost:8001/Chat/'+gci.data.id);\r\n      gci.data.dollarws.setWs(gci.data.ws);\r\n      gci.data.ws.onopen =function(){};\r\n      gci.data.ws.onmessage=function(data){gci.data.chats.push(JSON.parse(data.data))}\r\n      gci.data.ws.onerror = function(){console.log(\"连接已出错...\");setTimeout(()=>{gci.data.socket()},gci.data.dollarws.delay)}\r\n      gci.data.ws.onclose = function(){setTimeout(()=>{gci.data.Socket()},2000)}\r\n      gci.data.ws.Send=function (){}\r\n    }\r\n    gci.data.Socket()\r\n  })\r\nreturn{}\r\n},\r\ndata(){\r\n  return{\r\n    id:1,\r\n    chats:[],\r\n    dollarws:\"\",\r\n    chatInput:\"\",\r\n    //ws:\"\",\r\n  }\r\n},\r\nmethods:{\r\n  SendMessage(){\r\n  this.dollarws.ws.send(this.chatInput)\r\n  this.chatInput=\"\"\r\n},\r\n}\r\n\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>"],"mappings":";AAkBA,SAAQA,kBAAkB,EAAEC,SAAS,QAAO,KAAK;AAEjD,eAAe;EACfC,KAAKA,CAAA,EAAE;IACL,MAAMC,GAAG,GAACH,kBAAkB,CAAC,CAAC;IAC9BC,SAAS,CAAC,MAAI;MACZE,GAAG,CAACC,IAAI,CAACC,MAAM,GAAC,YAAU;QACxBF,GAAG,CAACC,IAAI,CAACE,EAAC,GAAI,IAAIC,SAAS,CAAC,2BAA2B,GAACJ,GAAG,CAACC,IAAI,CAACI,EAAE,CAAC;QACpEL,GAAG,CAACC,IAAI,CAACK,QAAQ,CAACC,KAAK,CAACP,GAAG,CAACC,IAAI,CAACE,EAAE,CAAC;QACpCH,GAAG,CAACC,IAAI,CAACE,EAAE,CAACK,MAAK,GAAG,YAAU,CAAC,CAAC;QAChCR,GAAG,CAACC,IAAI,CAACE,EAAE,CAACM,SAAS,GAAC,UAASR,IAAI,EAAC;UAACD,GAAG,CAACC,IAAI,CAACS,KAAK,CAACC,IAAI,CAACC,IAAI,CAACC,KAAK,CAACZ,IAAI,CAACA,IAAI,CAAC,CAAC;QAAA;QAC/ED,GAAG,CAACC,IAAI,CAACE,EAAE,CAACW,OAAM,GAAI,YAAU;UAACC,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;UAACC,UAAU,CAAC,MAAI;YAACjB,GAAG,CAACC,IAAI,CAACiB,MAAM,CAAC,CAAC;UAAA,CAAC,EAAClB,GAAG,CAACC,IAAI,CAACK,QAAQ,CAACa,KAAK,CAAC;QAAA;QACpHnB,GAAG,CAACC,IAAI,CAACE,EAAE,CAACiB,OAAM,GAAI,YAAU;UAACH,UAAU,CAAC,MAAI;YAACjB,GAAG,CAACC,IAAI,CAACC,MAAM,CAAC,CAAC;UAAA,CAAC,EAAC,IAAI,CAAC;QAAA;QACzEF,GAAG,CAACC,IAAI,CAACE,EAAE,CAACkB,IAAI,GAAC,YAAW,CAAC;MAC/B;MACArB,GAAG,CAACC,IAAI,CAACC,MAAM,CAAC;IAClB,CAAC;IACH,OAAM,CAAC;EACP,CAAC;EACDD,IAAIA,CAAA,EAAE;IACJ,OAAM;MACJI,EAAE,EAAC,CAAC;MACJK,KAAK,EAAC,EAAE;MACRJ,QAAQ,EAAC,EAAE;MACXgB,SAAS,EAAC;MACV;IACF;EACF,CAAC;;EACDC,OAAO,EAAC;IACNC,WAAWA,CAAA,EAAE;MACb,IAAI,CAAClB,QAAQ,CAACH,EAAE,CAACsB,IAAI,CAAC,IAAI,CAACH,SAAS;MACpC,IAAI,CAACA,SAAS,GAAC,EAAC;IAClB;EACA;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}