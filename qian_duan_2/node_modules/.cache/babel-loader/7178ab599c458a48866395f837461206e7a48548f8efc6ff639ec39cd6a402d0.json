{"ast":null,"code":"import { createElementVNode as _createElementVNode, withKeys as _withKeys, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"display\": \"flex\",\n    \"flex-direction\": \"column\",\n    \"background-color\": \"white\",\n    \"width\": \"1000px\",\n    \"padding-top\": \"10px\"\n  }\n};\nconst _hoisted_2 = {\n  style: {\n    \"display\": \"flex\",\n    \"align-items\": \"center\"\n  }\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"p\", {\n  style: {\n    \"font-size\": \"30px\"\n  }\n}, \"标题:\", -1 /* HOISTED */);\nconst _hoisted_4 = {\n  style: {\n    \"display\": \"flex\",\n    \"align-items\": \"center\",\n    \"margin-top\": \"10px\"\n  }\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"p\", null, \"类型:\", -1 /* HOISTED */);\nconst _hoisted_6 = {\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_7 = {\n  type: \"file\",\n  ref: \"file\",\n  accept: \"image/png, image/jpeg, image/gif, image/jpg\",\n  style: {\n    \"height\": \"30px\",\n    \"margin-top\": \"10px\",\n    \"margin-left\": \"2%\",\n    \"opacity\": \"1\"\n  }\n};\nconst _hoisted_8 = [\"innerHTML\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    ref: \"titleRef\",\n    onKeydown: _cache[0] || (_cache[0] = _withKeys($event => $setup.typeRef.focus(), [\"enter\"])),\n    style: {\n      \"resize\": \"none\",\n      \"height\": \"30px\",\n      \"width\": \"600px\",\n      \"border-radius\": \"10px\",\n      \"font-size\": \"25px\",\n      \"background-color\": \"lightblue\"\n    },\n    maxlength: \"30\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.blogData.title = $event)\n  }, null, 544 /* HYDRATE_EVENTS, NEED_PATCH */), [[_vModelText, $data.blogData.title]])]), _createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _withDirectives(_createElementVNode(\"input\", {\n    ref: \"typeRef\",\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.blogData.type = $event),\n    style: {\n      \"background-color\": \"lightgreen\",\n      \"width\": \"140px\",\n      \"height\": \"30px\",\n      \"border-radius\": \"10px\"\n    },\n    maxlength: \"10\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.blogData.type]])]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"input\", _hoisted_7, null, 512 /* NEED_PATCH */), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.AddImage && $options.AddImage(...args)),\n    style: {\n      \"cursor\": \"pointer\",\n      \"background-color\": \"deepskyblue\",\n      \"border-radius\": \"5px\",\n      \"color\": \"white\",\n      \"width\": \"10%\",\n      \"height\": \"30px\",\n      \"margin-top\": \"10px\",\n      \"font-size\": \"1rem\"\n    }\n  }, \"添加图片\")]), _createElementVNode(\"div\", {\n    ref: \"contentRef\",\n    style: {\n      \"border-top\": \"solid 1px lightgray\",\n      \"margin-top\": \"10px\",\n      \"width\": \"700px\",\n      \"border-bottom\": \"solid 1px lightgray\",\n      \"min-height\": \"700px\"\n    },\n    onKeydown: _cache[4] || (_cache[4] = _withModifiers((...args) => $options.Save && $options.Save(...args), [\"ctrl\"]))\n  }, [_createElementVNode(\"div\", {\n    contenteditable: \"\",\n    innerHTML: $data.blogData.content,\n    style: {\n      \"width\": \"700px\",\n      \"min-height\": \"50px\",\n      \"resize\": \"none\",\n      \"font-size\": \"25px\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_8)], 544 /* HYDRATE_EVENTS, NEED_PATCH */), _createElementVNode(\"button\", {\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.FixBlog && $options.FixBlog(...args)),\n    style: {\n      \"align-self\": \"center\",\n      \"background-color\": \"deepskyblue\",\n      \"height\": \"50px\",\n      \"width\": \"200px\",\n      \"cursor\": \"pointer\",\n      \"border-radius\": \"5px\",\n      \"margin-top\": \"30px\",\n      \"color\": \"white\",\n      \"font-size\": \"30px\"\n    }\n  }, \"修改\")]);\n}","map":{"version":3,"names":["style","_createElementVNode","type","ref","accept","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","onKeydown","_cache","_withKeys","$event","$setup","typeRef","focus","maxlength","$data","blogData","title","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","onClick","args","$options","AddImage","_withModifiers","Save","contenteditable","innerHTML","content","FixBlog"],"sources":["D:\\lin_hai_bo_ke\\qian_duan_2\\src\\Views\\Fixing.vue"],"sourcesContent":["<template>\r\n    <div style=\"display:flex;flex-direction:column;background-color:white;width:1000px;padding-top:10px;\">\r\n      <div style=\"display:flex;align-items:center;\">\r\n        <p style=\"font-size:30px;\">标题:</p>\r\n        <input type=\"text\" ref=\"titleRef\" @keydown.enter=\"typeRef.focus()\" style=\"resize:none;height:30px;width:600px;border-radius:10px;font-size:25px;background-color:lightblue;\" maxlength=\"30\" v-model=\"blogData.title\">\r\n      </div>\r\n      <div style=\"display:flex;align-items:center;margin-top:10px;\">\r\n        <p>类型:</p>\r\n        <input  ref=\"typeRef\" type=\"text\" v-model=\"blogData.type\" style=\"background-color:lightgreen;width:140px;height:30px;border-radius:10px;\" maxlength=\"10\">\r\n      </div>\r\n      <div style=\"display:flex;\">\r\n        <input type=\"file\" ref=\"file\" accept=\"image/png, image/jpeg, image/gif, image/jpg\" style=\"height:30px;margin-top:10px;margin-left:2%;opacity:1\"/>\r\n        <button @click=\"AddImage\" style=\"cursor:pointer;background-color:deepskyblue;border-radius:5px;color:white;width:10%;height:30px;margin-top:10px;font-size:1rem;\">添加图片</button>\r\n      </div>\r\n      <div ref=\"contentRef\" style=\"border-top:solid 1px lightgray;margin-top:10px;width:700px;border-bottom:solid 1px lightgray;min-height:700px;\" @keydown.ctrl=\"Save\">\r\n        <div  contenteditable v-html=\"blogData.content\" style=\"width:700px;min-height:50px;resize:none;font-size:25px;\"></div>\r\n      </div>\r\n      <button @click=\"FixBlog\" style=\"align-self:center;background-color:deepskyblue;height:50px;width:200px;cursor:pointer;border-radius:5px;margin-top:30px;color:white;font-size:30px;\">修改</button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {getCurrentInstance, onMounted, ref} from \"vue\";\r\nimport axios from \"axios\";\r\nimport router from \"../Router/First\";\r\nexport default {\r\nsetup(){\r\n  document.title=\"修改博客\"\r\n  const gci=getCurrentInstance()\r\n  let titleRef=ref(null)\r\n  let typeRef=ref(null)\r\n  let contentRef=ref(null)\r\n  let file    = ref(null)\r\n  onMounted(async ()=>{\r\n    gci.data.id = gci.appContext.config.globalProperties.$id\r\n    gci.data.blogId=router.currentRoute.value.query.blogId\r\n    await axios.get('http://114.55.38.94:8001/GetBlog',{params:{\"blogId\":gci.data.blogId}}).then(function (res){\r\n      gci.data.blogData=res.data.data\r\n    })\r\n  })\r\n  return{\r\n    titleRef,typeRef,contentRef,file\r\n  }\r\n},\r\ndata(){\r\n  return{\r\n    blogData:{},\r\n    titleOk:true,\r\n    typeOk:true,\r\n  }\r\n},\r\nmounted(){\r\n  window.DeleteImage=this.DeleteImage\r\n   window.addEventListener(\"beforeunload\", (event) =>{\r\n        console.log(event)      \r\n        return \"关闭\"\r\n     }\r\n   );\r\n},\r\nmethods:{\r\n// beforeunloadHandler(e){\r\n//   print(e)\r\n//   if (e) {\r\n//     e = e || window.event;\r\n//     if (e) {\r\n//       e.returnValue = \"关闭提示\";\r\n//     }\r\n//     return \"关闭提示\";\r\n//   }\r\n// },\r\nSave(e){\r\n  if(e.keyCode==65){\r\n    this.FixBlog()\r\n  }\r\n},\r\nFixBlog(){\r\n  let sureFix=confirm(\"点击“确定”修改,点击”取消“停止\")\r\n  if(sureFix==true){\r\n    const blog=new URLSearchParams\r\n    blog.append(\"id\",this.id);\r\n    blog.append(\"blogId\",this.blogId);\r\n    blog.append(\"title\",this.titleRef.value)\r\n    blog.append(\"type\",this.typeRef.value)\r\n    blog.append(\"content\",this.contentRef.innerHTML)\r\n    axios.post(\"http://114.55.38.94:8001/FixBlog\",blog).then(function (res){\r\n      if(res.data.data==\"修改博客成功\"){\r\n        alert(\"修改博客成功\")\r\n        window.close()\r\n      }else{alert(\"系统繁忙,请稍后重试\")}\r\n    })\r\n  }\r\n  window.close()\r\n},\r\nAddImage(){\r\n  let fd = new FormData\r\n  fd.append(\"id\",this.id)\r\n  fd.append(\"file\",this.file.files[0])\r\n  const that=this\r\n  axios.post(\"http://114.55.38.94:8001/UploadImage\",fd,{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then((res)=>{\r\n    that.file.value=''\r\n    that.content.innerHTML=that.content.innerHTML+\"<img src='http://114.55.38.94:8001/picture/\"+res.data.data+\"' style='max-width:300px;max-height:300px;min-width:30px;min-height:30px'>\"+ \"<div contentEditable style='margin-top:20px;width:700px;min-height:100px;resize:none;font-size:25px;'></div>\"\r\n  })\r\n},\r\nDeleteImage(){\r\n  event.currentTarget.parentElement.remove()\r\n  axios.get(\"http://114.55.38.94:8001/DeleteImage\",{params:{id:this.id,imageName:event.currentTarget.parentElement.firstElementChild.getAttribute(\"src\")}}).then(()=>{})\r\n},\r\n},\r\n}\r\n</script>\r\n<style scoped></style>"],"mappings":";;EACSA,KAAgG,EAAhG;IAAA;IAAA;IAAA;IAAA;IAAA;EAAA;AAAgG;;EAC9FA,KAAwC,EAAxC;IAAA;IAAA;EAAA;AAAwC;gCAC3CC,mBAAA,CAAkC;EAA/BD,KAAuB,EAAvB;IAAA;EAAA;AAAuB,GAAC,KAAG;;EAG3BA,KAAwD,EAAxD;IAAA;IAAA;IAAA;EAAA;AAAwD;gCAC3DC,mBAAA,CAAU,WAAP,KAAG;;EAGHD,KAAqB,EAArB;IAAA;EAAA;AAAqB;;EACjBE,IAAI,EAAC,MAAM;EAACC,GAAG,EAAC,MAAM;EAACC,MAAM,EAAC,6CAA6C;EAACJ,KAA4D,EAA5D;IAAA;IAAA;IAAA;IAAA;EAAA;;;;uBAVvFK,mBAAA,CAiBM,OAjBNC,UAiBM,GAhBJL,mBAAA,CAGM,OAHNM,UAGM,GAFJC,UAAkC,E,gBAClCP,mBAAA,CAAqN;IAA9MC,IAAI,EAAC,MAAM;IAACC,GAAG,EAAC,UAAU;IAAEM,SAAO,EAAAC,MAAA,QAAAA,MAAA,MAAAC,SAAA,CAAAC,MAAA,IAAQC,MAAA,CAAAC,OAAO,CAACC,KAAK;IAAIf,KAAyG,EAAzG;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA,CAAyG;IAACgB,SAAS,EAAC,IAAI;+DAAUC,KAAA,CAAAC,QAAQ,CAACC,KAAK,GAAAP,MAAA;iEAAdK,KAAA,CAAAC,QAAQ,CAACC,KAAK,E,KAErNlB,mBAAA,CAGM,OAHNmB,UAGM,GAFJC,UAAU,E,gBACVpB,mBAAA,CAAyJ;IAAjJE,GAAG,EAAC,SAAS;IAACD,IAAI,EAAC,MAAM;+DAAUe,KAAA,CAAAC,QAAQ,CAAChB,IAAI,GAAAU,MAAA;IAAEZ,KAA+E,EAA/E;MAAA;MAAA;MAAA;MAAA;IAAA,CAA+E;IAACgB,SAAS,EAAC;iDAAzGC,KAAA,CAAAC,QAAQ,CAAChB,IAAI,E,KAE1DD,mBAAA,CAGM,OAHNqB,UAGM,GAFJrB,mBAAA,CAAiJ,SAAjJsB,UAAiJ,+BACjJtB,mBAAA,CAA+K;IAAtKuB,OAAK,EAAAd,MAAA,QAAAA,MAAA,UAAAe,IAAA,KAAEC,QAAA,CAAAC,QAAA,IAAAD,QAAA,CAAAC,QAAA,IAAAF,IAAA,CAAQ;IAAEzB,KAAuI,EAAvI;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA;KAAwI,MAAI,E,GAExKC,mBAAA,CAEM;IAFDE,GAAG,EAAC,YAAY;IAACH,KAAsH,EAAtH;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA,CAAsH;IAAES,SAAO,EAAAC,MAAA,QAAAA,MAAA,MAAAkB,cAAA,KAAAH,IAAA,KAAOC,QAAA,CAAAG,IAAA,IAAAH,QAAA,CAAAG,IAAA,IAAAJ,IAAA,CAAI;MAC9JxB,mBAAA,CAAsH;IAAhH6B,eAAe,EAAf,EAAe;IAACC,SAAyB,EAAjBd,KAAA,CAAAC,QAAQ,CAACc,OAAO;IAAEhC,KAA+D,EAA/D;MAAA;MAAA;MAAA;MAAA;IAAA;+EAElDC,mBAAA,CAAgM;IAAvLuB,OAAK,EAAAd,MAAA,QAAAA,MAAA,UAAAe,IAAA,KAAEC,QAAA,CAAAO,OAAA,IAAAP,QAAA,CAAAO,OAAA,IAAAR,IAAA,CAAO;IAAEzB,KAA2J,EAA3J;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;MAAA;IAAA;KAA4J,IAAE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}