"use strict";(self["webpackChunkqian_duan_2"]=self["webpackChunkqian_duan_2"]||[]).push([[610],{1610:function(e,t,i){i.r(t),i.d(t,{default:function(){return z}});var l=i(3396),n=i(9242),a=i(7139);const o={style:{display:"flex","flex-direction":"column","background-color":"white","padding-left":"2%","padding-top":"10px"}},d={style:{display:"flex","align-items":"center"}},r=(0,l._)("p",{style:{"font-size":"1rem"}},"标题:",-1),p={key:0,style:{color:"red","margin-left":"22%"}},s={key:1,style:{"margin-left":"2%",color:"lightblue"}},g={style:{display:"flex","align-items":"center","margin-top":"1%"}},u=(0,l._)("p",null,"类型:",-1),c=(0,l._)("option",{value:""},"请选择",-1),h=["value"],m={style:{display:"flex"}},y={type:"file",ref:"file",accept:"image/png, image/jpeg, image/gif, image/jpg",style:{height:"30px","margin-top":"10px","margin-left":"2%",opacity:"1"}},f=(0,l._)("div",{contenteditable:"",style:{width:"100%","min-height":"50px",resize:"none","font-size":"1rem"}},null,-1),x=[f];function w(e,t,i,f,w,b){return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",d,[r,(0,l.wy)((0,l._)("input",{type:"text",onKeydown:t[0]||(t[0]=(0,n.D2)((e=>f.typeRef.focus()),["enter"])),style:{resize:"none",height:"30px",width:"50%","border-radius":"10px","font-size":"1rem","background-color":"lightblue"},maxlength:"30","onUpdate:modelValue":t[1]||(t[1]=e=>w.title=e),onInput:t[2]||(t[2]=(...e)=>b.JudgeTitle&&b.JudgeTitle(...e)),onBlur:t[3]||(t[3]=(...e)=>b.ExameTitle&&b.ExameTitle(...e))},null,544),[[n.nr,w.title]]),w.titleOk?((0,l.wg)(),(0,l.iD)("p",s,"还可输入"+(0,a.zw)(w.couldTitle)+"字",1)):((0,l.wg)(),(0,l.iD)("p",p,"标题不能为空"))]),(0,l._)("div",g,[u,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>w.kind=e),style:{border:"black solid 0.1rem","background-color":"lightblue"}},[c,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.types,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.tId,value:e.kind},(0,a.zw)(e.kind),9,h)))),128))],512),[[n.bM,w.kind]])]),(0,l._)("div",m,[(0,l._)("input",y,null,512),(0,l._)("button",{onClick:t[5]||(t[5]=(...e)=>b.AddImage&&b.AddImage(...e)),style:{cursor:"pointer","background-color":"deepskyblue","border-radius":"5px",color:"white",width:"10%",height:"30px","margin-top":"10px","font-size":"1rem"}},"添加图片")]),(0,l._)("div",{ref:"content",style:{border:"solid 1px lightgray","margin-top":"10px",width:"50%","min-height":"700px"},onKeydown:t[6]||(t[6]=(0,n.iM)(((...e)=>b.Save&&b.Save(...e)),["ctrl"]))},x,544),(0,l._)("button",{onClick:t[7]||(t[7]=(...e)=>b.ReleaseBlog&&b.ReleaseBlog(...e)),style:{"background-color":"deepskyblue",height:"50px",width:"20%",cursor:"pointer","border-radius":"5px","margin-top":"30px",color:"white","font-size":"2rem","margin-left":"15%"}},"提交")])}i(7658);var b=i(4870),k=i(2483),v=i(4161),T=i(8229),_={setup(){const e=(0,l.FN)();let t=(0,b.iH)(null),i=(0,b.iH)(null),n=(0,b.iH)(null),a=(0,b.iH)(null);return(0,k.iS)(((e,t,i)=>{let l=confirm("是否离开");i(!!l)})),(0,l.bv)((async()=>{document.title="发布博客",document.documentElement.style.fontSize=document.documentElement.clientWidth/100+"px",e.data.id=e.appContext.config.globalProperties.$id,e.data.avatar=e.appContext.config.globalProperties.$avatar,v.Z.get("http://114.55.38.94:8001/SelectKinds").then((t=>{e.data.types=t.data.data}))})),{blogRef:i,typeRef:t,content:n,file:a}},data(){return{id:"",title:"",titleOk:!0,couldTitle:30,kind:"",couldType:10,imageUrl:null,types:[]}},mounted(){window.DeleteImage=this.DeleteImage,window.addEventListener("beforeunload",(e=>this.beforeunloadHandler(e)))},methods:{beforeunloadHandler(e){if(e)return e=e||window.event,e&&(e.returnValue="关闭提示"),"关闭提示"},Save(e){65==e.keyCode&&this.ReleaseBlog()},ReleaseBlog(){const e=this;v.Z.get("http://114.55.38.94:8001/ReleaseBlog",{params:{id:e.id,title:e.title,type:e.kind,content:e.content.innerHTML}}).then((t=>{"发布成功"==t.data.data?(alert("发布成功"),T.Z.push("/Index"),e.mitt1.emit("Reload")):alert("发布失败")}))},AddImage(){let e=new FormData;e.append("id",this.id),e.append("file",this.file.files[0]);const t=this;v.Z.post("http://114.55.38.94:8001/UploadImage",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>{t.file.value="",t.content.innerHTML=t.content.innerHTML+"<div style='display:flex;flex-direction:row'> <img src='http://114.55.38.94:8001/picture/"+e.data.data+"' style='max-width:300px;max-height:300px;min-width:30px;min-height:30px'><img src='http://114.55.38.94:8001/picture/deleteIcon.png' onclick='DeleteImage()' style='width:2rem;height:2rem;margin-left:2rem;cursor:pointer;'></div><div contentEditable style='width:700px;resize:none;font-size:25px;'></div>"}))},JudgeTitle(){this.ExameTitle(),this.couldTitle=30-this.title.length},JudgeType(){this.ExameType(),this.couldType=10-this.type.length},ExameTitle(){0!=this.title.length?this.titleOk=!0:this.titleOk=!1},DeleteImage(){event.currentTarget.parentElement.remove(),v.Z.get("http://114.55.38.94:8001/DeleteImage",{params:{id:this.id,imageName:event.currentTarget.parentElement.firstElementChild.getAttribute("src")}}).then((()=>{}))},ExameType(){0!=this.type.length?this.typeOk=!0:this.typeOk=!1}}},E=i(89);const I=(0,E.Z)(_,[["render",w]]);var z=I}}]);
//# sourceMappingURL=610.4c4a5e58.js.map