"use strict";(self["webpackChunkqian_duan_2"]=self["webpackChunkqian_duan_2"]||[]).push([[8],{8008:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var i=n(3396),a=n(9242);const l={style:{display:"flex","flex-direction":"column","background-color":"white",width:"1000px","padding-top":"10px"}},o={style:{display:"flex","align-items":"center"}},r=(0,i._)("p",{style:{"font-size":"30px"}},"标题:",-1),d={style:{display:"flex","align-items":"center","margin-top":"10px"}},p=(0,i._)("p",null,"类型:",-1),g={style:{display:"flex"}},s={type:"file",ref:"file",accept:"image/png, image/jpeg, image/gif, image/jpg",style:{height:"30px","margin-top":"10px","margin-left":"2%",opacity:"1"}},u=["innerHTML"];function h(e,t,n,h,c,x){return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",o,[r,(0,i.wy)((0,i._)("input",{type:"text",ref:"titleRef",onKeydown:t[0]||(t[0]=(0,a.D2)((e=>h.typeRef.focus()),["enter"])),style:{resize:"none",height:"30px",width:"600px","border-radius":"10px","font-size":"25px","background-color":"lightblue"},maxlength:"30","onUpdate:modelValue":t[1]||(t[1]=e=>c.blogData.title=e)},null,544),[[a.nr,c.blogData.title]])]),(0,i._)("div",d,[p,(0,i.wy)((0,i._)("input",{ref:"typeRef",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>c.blogData.type=e),style:{"background-color":"lightgreen",width:"140px",height:"30px","border-radius":"10px"},maxlength:"10"},null,512),[[a.nr,c.blogData.type]])]),(0,i._)("div",g,[(0,i._)("input",s,null,512),(0,i._)("button",{onClick:t[3]||(t[3]=(...e)=>x.AddImage&&x.AddImage(...e)),style:{cursor:"pointer","background-color":"deepskyblue","border-radius":"5px",color:"white",width:"10%",height:"30px","margin-top":"10px","font-size":"1rem"}},"添加图片")]),(0,i._)("div",{ref:"contentRef",style:{"border-top":"solid 1px lightgray","margin-top":"10px",width:"700px","border-bottom":"solid 1px lightgray","min-height":"700px"},onKeydown:t[4]||(t[4]=(0,a.iM)(((...e)=>x.Save&&x.Save(...e)),["ctrl"]))},[(0,i._)("div",{contenteditable:"",innerHTML:c.blogData.content,style:{width:"700px","min-height":"50px",resize:"none","font-size":"25px"}},null,8,u)],544),(0,i._)("button",{onClick:t[5]||(t[5]=(...e)=>x.FixBlog&&x.FixBlog(...e)),style:{"align-self":"center","background-color":"deepskyblue",height:"50px",width:"200px",cursor:"pointer","border-radius":"5px","margin-top":"30px",color:"white","font-size":"30px"}},"修改")])}n(6229),n(7330),n(2062);var c=n(4870),x=n(4161),f=n(8229),m={setup(){document.title="修改博客";const e=(0,i.FN)();let t=(0,c.iH)(null),n=(0,c.iH)(null),a=(0,c.iH)(null),l=(0,c.iH)(null);return(0,i.bv)((async()=>{e.data.id=e.appContext.config.globalProperties.$id,e.data.blogId=f.Z.currentRoute.value.query.blogId,await x.Z.get("http://114.55.38.94:8001/GetBlog",{params:{blogId:e.data.blogId}}).then((function(t){e.data.blogData=t.data.data}))})),{titleRef:t,typeRef:n,contentRef:a,file:l}},data(){return{blogData:{},titleOk:!0,typeOk:!0}},mounted(){window.DeleteImage=this.DeleteImage,window.addEventListener("beforeunload",(e=>this.beforeunloadHandler(e)))},methods:{beforeunloadHandler(e){if(e)return e=e||window.event,e&&(e.returnValue="关闭提示"),"关闭提示"},Save(e){65==e.keyCode&&this.FixBlog()},FixBlog(){let e=confirm("点击“确定”修改,点击”取消“停止");if(1==e){const e=new URLSearchParams;e.append("id",this.id),e.append("blogId",this.blogId),e.append("title",this.titleRef.value),e.append("type",this.typeRef.value),e.append("content",this.contentRef.innerHTML),x.Z.post("http://114.55.38.94:8001/FixBlog",e).then((function(e){"修改博客成功"==e.data.data?(alert("修改博客成功"),window.close()):alert("系统繁忙,请稍后重试")}))}window.close()},AddImage(){let e=new FormData;e.append("id",this.id),e.append("file",this.file.files[0]);const t=this;x.Z.post("http://114.55.38.94:8001/UploadImage",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>{t.file.value="",t.content.innerHTML=t.content.innerHTML+"<img src='http://114.55.38.94:8001/picture/"+e.data.data+"' style='max-width:300px;max-height:300px;min-width:30px;min-height:30px'><div contentEditable style='margin-top:20px;width:700px;min-height:100px;resize:none;font-size:25px;'></div>"}))},DeleteImage(){event.currentTarget.parentElement.remove(),x.Z.get("http://114.55.38.94:8001/DeleteImage",{params:{id:this.id,imageName:event.currentTarget.parentElement.firstElementChild.getAttribute("src")}}).then((()=>{}))}}},y=n(89);const b=(0,y.Z)(m,[["render",h]]);var w=b}}]);
//# sourceMappingURL=8.3d7f02ed.js.map